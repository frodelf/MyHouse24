<div th:fragment="menu">
    <!--  navbar  -->
    <nav class="main-header navbar navbar-expand" th:classappend="${theme == 'LIGHT' ? 'navbar-light' : 'navbar-dark'}">
        <ul class="navbar-nav" style="width: 100%">
            <li class="nav-item">
                <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
            </li>
            <li class="nav-item d-none d-sm-inline-block">
                <div class="nav-link">
                    <span th:text="#{Панель_Администратора}"></span>
                </div>
            </li>
            <li class="nav-item ml-auto">
                <div class="row">
                    <div class="col-4">
                        <button type="button" id="themeSwitchButton" class="btn" style="outline: none"><p style="margin-bottom: 0px" id="cookieDisplay"></p>
                        </button>
                    </div>
                    <div class="col-4">
                        <select id="languageSelect" style="width: 50px" class="form-control" onchange="changeLanguage()">
                            <option value="ru" th:selected="${#locale.language == 'ru'}">ru</option>
                            <option value="uk" th:selected="${#locale.language == 'uk'}">uk</option>
                        </select>
                    </div>
                    <div class="col-4"></div>
                </div>
            </li>
        </ul>
    </nav>

    <!--  sidebar  -->
    <aside class="main-sidebar elevation-4" th:classappend="${theme == 'LIGHT' ? 'sidebar-light-primary' : 'sidebar-dark-primary'}">
        <a href="/admin/" id="aside-for-theme" class="brand-link" style="height: 56.67px;padding: 3px;">
            <img src="/images/logo.png" alt="AdminLTE Logo" class="logo-image"
                 style="opacity: .8; width:75%; margin:auto;">
            <img src="/images/logo-mini.png" alt="AdminLTE Logo Mini" class="mini-logo-image"
                 style="opacity: .8; width:50px; height: 48px; margin:auto;">
        </a>
        <div class="sidebar os-host os-theme-black os-host-overflow os-host-overflow-y os-host-resize-disabled os-host-scrollbar-horizontal-hidden os-host-transition">
            <div class="os-padding">
                <div class="os-viewport os-viewport-native-scrollbars-invisible" style="overflow-y: scroll;">
                    <div class="os-content" style="padding: 0px 8px; height: 100%; width: 100%;">
                        <nav class="mt-2">
                            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                                <li class="nav-item">
                                    <a href="/admin" style="width:100%" class="nav-link selected">
                                        <i class="fa fa-chart-line"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Статистика}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/account-transaction/index/1" style="width:100%; " class="nav-link">
                                        <i class="fa fa-dollar-sign" aria-hidden="true" style="width:16px"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Касса}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/invoice/index/1" style="width:100%; " class="nav-link">
                                        <i class="fa fa-file" aria-hidden="true"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Квитанции_на_оплату}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/account/index/1" style="width:100%; " class="nav-link">
                                        <i class="fa fa-credit-card" aria-hidden="true"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Лицевые_счета}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/flat/index/1" style="width:100%;" class="nav-link">
                                        <i class="fa fa-key" aria-hidden="true"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Квартиры}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/user/index/1" style="width:100%; " class="nav-link">
                                        <i class="fa fa-users" aria-hidden="true" style="font-size: 14px"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Владельцы_квартир}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/house/index/1" style="width:100%; " class="nav-link">
                                        <i class="fa fa-building" aria-hidden="true" style="width:16px"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Дома}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/message/index/1" style="width:100%;" class="nav-link">
                                        <i class="fa fa-envelope" aria-hidden="true"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Сообщения}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/master-request/index/1" style="width:100%; " class="nav-link">
                                        <i class="fa fa-wrench" aria-hidden="true"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Заявки_вызова_мастера}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/counter-data/index/1" style="width:100%;" class="nav-link">
                                        <i class="fa fa-weight" aria-hidden="true"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Показания_счетчиков}"></span>
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link2 nav-link">
                                        <i class="fa fa-desktop"></i>
                                        <p>
                                            <span th:text="#{Управление_сайтом}"></span>
                                        </p>
                                        <i class="right fas fa-angle-left"></i>
                                    </a>
                                    <ul class="nav nav-treeview">
                                        <li class="nav-item">
                                            <a href="/index" class="nav-link" >
                                                <i class="far fa-circle nav-icon"></i>
                                                <p>
                                                    <span th:text="#{Главная_страница}"></span>
                                                </p>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a href="/about" class="nav-link" >
                                                <i class="far fa-circle nav-icon"></i>
                                                <p>
                                                    <span th:text="#{О_нас}"></span>
                                                </p>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a href="/services" class="nav-link" style="width:100%;">
                                                <i class="far fa-circle nav-icon"></i>
                                                <p>
                                                    <span th:text="#{Услуги}"></span>
                                                </p>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a href="/contacts" class="nav-link" style="width:100%;">
                                                <i class="far fa-circle nav-icon"></i>
                                                <p>
                                                    <span th:text="#{Контакты}"></span>
                                                </p>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="nav-item">
                                    <a href="#" style="width:100%" class="nav-link2 nav-link">
                                        <i class="fa fa-cogs" aria-hidden="true"></i>
                                        <p class="pl-1">
                                            <span th:text="#{Настройка_системы}"></span>
                                        </p>
                                        <i class="right fas fa-angle-left"></i>
                                    </a>
                                    <ul class="nav nav-treeview" style="font-weight: 400">
                                        <li class="nav-item dropdown-items">
                                            <a href="/admin/service/index" class="nav-link dropdown-links" style="margin:0; width:100%;">
                                                <i style="font-size: 12px;" class="fa fa-briefcase nav-icon" aria-hidden="true"></i>
                                                <p>
                                                    <span th:text="#{Услуги}"></span>
                                                </p>
                                            </a>
                                        </li>
                                        <li class="nav-item dropdown-items">
                                            <a href="/admin/tariff/index" class="nav-link dropdown-links" style="margin:0; width:100%; ">
                                                <i style="font-size: 12px;" class="fa fa-money-bill nav-icon" aria-hidden="true"></i>
                                                <p>
                                                    <span th:text="#{Тарифы}"></span>
                                                </p>
                                            </a>
                                        </li>
                                        <li class="nav-item dropdown-items">
                                            <a href="/admin/user-admin/index/1" class="nav-link dropdown-links" style="margin:0; width:100%;">
                                                <i style="font-size: 12px;" class="fa fa-user-plus nav-icon" aria-hidden="true"></i>
                                                <p>
                                                    <span th:text="#{Пользователи}"></span>
                                                </p>
                                            </a>
                                        </li>
                                        <li class="nav-item dropdown-items">
                                            <a href="/admin/role-form" class="nav-link dropdown-links" style="margin:0; width:100%;">
                                                <i style="font-size: 12px;" class="fa fa-users nav-icon" aria-hidden="true"></i>
                                                <p>
                                                    <span th:text="#{Пользователи}"></span>
                                                    Роли</p>
                                            </a>
                                        </li>
                                        <li class="nav-item dropdown-items">
                                            <a href="/admin/pay-company/index" class="nav-link dropdown-links" style="margin:0; width:100%;">
                                                <i style="font-size: 12px;" class="fa fa-credit-card nav-icon" aria-hidden="true"></i>
                                                <p>
                                                    <span th:text="#{Платежные_реквизиты}"></span>
                                                </p>
                                            </a>
                                        </li>
                                        <li class="nav-item dropdown-items">
                                            <a href="/admin/transaction-purpose/index" class="nav-link dropdown-links" style="width:100%;  margin: 0 0 50px;">
                                                <i style="font-size: 12px;" class="fa fa-list-ol nav-icon" aria-hidden="true"></i>
                                                <p>
                                                    <span th:text="#{Статьи_платежей}"></span>
                                                </p>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </aside>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var select2Elements = document.querySelectorAll('.select2');
            const themeToggle = $("#themeToggle");
            const body = $("body");
            const nav = $("nav");
            const aside = $("aside");
            const asideForTheme = $("#aside-for-theme");
            let darkModeEnabled = false;
            toggleTheme()
            function toggleTheme() {
                darkModeEnabled = !darkModeEnabled;
                const theme = getCookie("theme");
                const tableRows = document.querySelectorAll("table tr");
                const tables = document.querySelectorAll("table");
                if (theme === "☁") {
                    body.addClass("dark-mode");
                    nav.removeClass("navbar-light").addClass("navbar-dark");
                    aside.removeClass("sidebar-light-primary").addClass("sidebar-dark-primary");
                    asideForTheme.css("background-color", "#343a40");
                    select2Elements.forEach(function(element) {
                        element.querySelector('.select2-selection').style.backgroundColor="#343a40";
                    });

                    tables.forEach(table =>{
                       table.classList.add("table-dark")
                    });
                    tableRows.forEach(row => {
                        row.classList.add("table-dark");
                    });
                    $(".text-for-breadcrumb").css("color", "#fff");
                } else {
                    body.removeClass("dark-mode");
                    nav.removeClass("navbar-dark").addClass("navbar-light");
                    aside.removeClass("sidebar-dark-primary").addClass("sidebar-light-primary");
                    asideForTheme.css("background-color", "");
                    select2Elements.forEach(function(element) {
                        element.querySelector('.select2-selection').style.backgroundColor="";
                    });

                    tables.forEach(table =>{
                        table.classList.remove("table-dark")
                    });
                    tableRows.forEach(row => {
                        console.log(row.classList)
                        row.classList.remove("table-dark");
                    });
                    $(".text-for-breadcrumb").css("color", "#212529BF");
                }
            }

            function setCookie(name, value) {
                const date = new Date();
                date.setTime(date.getTime() + (365 * 24 * 60 * 60 * 1000));
                const expires = '; expires=' + date.toUTCString();
                document.cookie = name + '=' + (value || '') + expires + '; path=/';
            }

            const cookieDisplayElement = document.getElementById('cookieDisplay');
            cookieDisplayElement.textContent = getCookie("theme")

            function getCookie(name) {
                const nameEQ = name + '=';
                const ca = document.cookie.split(';');
                for (let i = 0; i < ca.length; i++) {
                    let c = ca[i];
                    while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
                }
                return null;
            }
            themeToggle.click(toggleTheme);

            const themeSwitchButton = document.getElementById("themeSwitchButton");
            themeSwitchButton.type='button';
            themeSwitchButton.addEventListener("click", function() {
                if (getCookie("theme") === "☁") {
                    setCookie("theme", "☀")
                    themeSwitchButton.textContent = "☀";
                    $.ajax({
                        url: '/admin/user-admin/change/theme/light',
                        method: 'GET',
                        success: function(response) {
                        },
                    });
                    console.log("light")
                    toggleTheme()
                } else {
                    setCookie("theme", "☁")
                    themeSwitchButton.textContent = "☁";
                    $.ajax({
                        url: '/admin/user-admin/change/theme/dark',
                        method: 'GET',
                        success: function(response) {
                        },
                    });
                    console.log("dark")
                    toggleTheme()
                }
            });
        });
        function changeLanguage() {
            var selectedLanguage = document.getElementById("languageSelect").value;
            window.location.search = "?lang=" + selectedLanguage;
        }
    </script>
</div>